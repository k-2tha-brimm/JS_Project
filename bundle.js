!function(t){var e={};function s(i){if(e[i])return e[i].exports;var h=e[i]={i:i,l:!1,exports:{}};return t[i].call(h.exports,h,h.exports,s),h.l=!0,h.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var h in t)s.d(i,h,function(e){return t[e]}.bind(null,h));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=3)}([function(t,e,s){s(2);t.exports=class{constructor(t){this.pos=t.pos,this.vel=t.vel,this.color=t.color,this.height=t.height,this.area=this.height*this.width,this.width=t.width,this.game=t.game}draw(t){t.fillStyle=this.color,t.fillRect(this.pos[0],this.pos[1],this.width,this.height)}move(){this.pos[0]+=this.vel[0]}remove(){this.game.remove(this)}}},function(t,e,s){s(2);const i=s(0);t.exports=class extends i{constructor(t){super(t),this.pos=t.pos,this.color="lime",this.width=25,this.height=10,this.vel=t.vel||[0,0],this.area=this.height*this.width}moveShip(t){this.vel[0]=t[0]}}},function(t,e){const s={constructor(t,e){this.x=t,this.y=e},add:(t,e)=>new s(t.x+e.x,t.y+e.y),subtract:(t,e)=>new s(t.x-e.x,t.y-e.y),multiply:(t,e)=>new s(t.x*e,t.y*e),vecLength:t=>Math.sqrt(t.x*t.x+t.y*t.y),distance:(t,e)=>Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]+e[1],2)),normalize:t=>new s(t.x/vectorLength(t),t.y/vectorLength(t))};t.exports=s},function(t,e,s){const i=s(1),h=s(0),o=s(4),n=s(8);document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("game-canvas");t.width=600,t.height=720;const e=t.getContext("2d"),s=new o(t);new n(s,e);s.draw(e),document.getElementById("start").addEventListener("click",()=>{const s=new o(t),i=new n(s,e);s.draw(e),i.start()})}),window.PlayerShip=i,window.Entities=h},function(t,e,s){const i=s(1),h=s(5),o=s(6),n=s(7);class l{constructor(t,e){this.enemyShips=[],this.bullets=[],this.bombs=[],this.waveCount=0,this.enemiesAdded=!1,this.playerShip=null,this.gameBoard=t,this.playerLives=3,this.score=e||0,this.gameIsOver=!1,this.newRound=!1,this.bombs=[],this.addEnemies(),this.addPlayerShip(),this.registerEvents()}addPlayerShip(){this.playerShip=new i({pos:[300,650],vel:[0,0],height:20,width:40,color:"lime"})}add(t){this.enemyShips.push(t)}addBullet(t){this.bullets.push(t)}addBombs(t){this.bombs.push(t)}addEnemies(){let t=100;for(let e=5;e>1;e--){let s=40;for(let i=0;i<11;i++)this.add(new h({pos:[s,t],vel:[1,0],game:this,value:10*e})),s+=45;t+=35}this.enemiesAdded=!0}draw(t){const e=new Image;e.src="../assets/images/halo.jpg",e.onload=(()=>{t.drawImage(e,-500,0)}),t.font="30px Comic Sans MS",t.fillstyle="white",t.fillText(`Score: ${this.score}`,410,50),t.font="30px Comic Sans MS",t.fillstyle="white",t.fillText(`Lives: ${this.playerLives}`,20,50),this.enemyShips.forEach(e=>{e.draw(t)}),this.playerShip.draw(t),this.bullets.forEach(e=>{e.draw(t)}),this.bombs.forEach(e=>{e.draw(t)})}bombsAway(){const t=Math.floor(Math.random()*Math.floor(this.enemyShips.length)),e=this.enemyShips[t],s=[[e.pos[0]-10,e.pos[1]+13]];this.addBombs(new n(s))}checkCollisions(){for(let t=0;t<this.enemyShips.length;t++){let e=this.enemyShips[t],s=!1;for(let t=0;t<this.bullets.length;t++){const i=this.bullets[t];if(i.pos[0]>=e.pos[0]-e.width/2&&i.pos[0]<=e.pos[0]+e.width/2&&i.pos[1]>=e.pos[1]-e.height/2&&i.pos[1]<=e.pos[1]+e.height/2){this.bullets.splice(t--,1),s=!0;break}}s&&(this.score+=this.enemyShips[t].value,this.enemyShips.splice(t--,1),0===this.enemyShips.length&&(this.bullets=[],this.addEnemies(),this.addPlayerShip(),this.registerEvents())),this.bullets.forEach(t=>{t.pos[1]<0&&this.bullets.splice(this.bullets.indexOf(t),1)})}}moveObjects(){this.enemyShips.forEach(t=>{this.gameOver(t.pos)&&this.enemyShips.map(t=>{t.vel=[0,0]});this.isOutOfBounds(t.pos)?t.pos[0]<0?this.enemyShips.map(t=>{t.pos[1]+=30,t.pos[0]+=10,t.vel=[1,0]}):this.enemyShips.map(t=>{t.pos[1]+=30,t.pos[0]-=10,t.vel=[-1,0]}):t.move()}),this.bullets.forEach(t=>{t.pos[1]-=t.vel[1]}),this.bombs.forEach(t=>{console.log(t.pos[1]+t.vel[1]),t.pos[1]+=t.vel[1]}),this.bombs.length<2&&this.bombsAway()}registerEvents(){let t={x:0,y:0};document.addEventListener("keydown",e=>{if(37===e.keyCode)this.isOutOfBounds(this.playerShip.pos)?this.playerShip.vel[0]=-2:this.playerShip.pos[0]-=20;else if(39===e.keyCode)this.isOutOfBounds(this.playerShip.pos)?this.playerShip.vel[0]=2:this.playerShip.pos[0]+=20;else if(32===e.keyCode){const t=[this.playerShip.pos[0]+10,this.playerShip.pos[1]-13];this.bullets.length<7&&this.addBullet(new o(t))}this.playerShip.moveShip(t)})}isOutOfBounds(t){return t[0]<0||t[0]+25>=l.WIDTH}gameOver(t){return t[1]>620&&(this.gameIsOver=!0,!0)}remove(t){t instanceof h?this.enemyShips.splice(this.enemyShips.indexOf(t),1):t instanceof o&&this.bullets.splice(this.bullets.indexOf(t),1)}}l.NUM_ENEMIES=55,l.HEIGHT=720,l.WIDTH=600,t.exports=l},function(t,e,s){const i=s(0);t.exports=class extends i{constructor(t){super(t),this.pos=t.pos,this.vel=t.vel,this.width=25,this.height=12,this.color="white",this.game=t.game,this.area=this.height*this.width,this.value=t.value}}},function(t,e,s){const i=s(0);t.exports=class extends i{constructor(t){super(t),this.pos=t,this.vel=[0,1.5],this.height=6,this.width=3,this.color="white",this.area=this.height*this.width}}},function(t,e,s){const i=s(0);t.exports=class extends i{constructor(t){super(t),this.pos=t[0],this.vel=[0,1.6],this.height=5,this.width=2.5,this.color="white"}}},function(t,e){t.exports=class{constructor(t,e){this.ctx=e,this.game=t,this.playerShip=t.addPlayerShip}animate(){this.game.draw(this.ctx),this.game.moveObjects(),this.game.checkCollisions(),this.game.gameIsOver?document.getElementById("splash-page").style.display="flex":requestAnimationFrame(this.animate.bind(this))}start(){this.lastTime=0,requestAnimationFrame(this.animate.bind(this))}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2VudGl0aWVzLmpzIiwid2VicGFjazovLy8uL3NyYy9wbGF5ZXJfc2hpcC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdmVjdG9ycy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2VuZW15X3NoaXAuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2J1bGxldC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYm9tYnMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2JvYXJkLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiW29iamVjdCBPYmplY3RdIiwicHJvcHMiLCJ0aGlzIiwicG9zIiwidmVsIiwiY29sb3IiLCJoZWlnaHQiLCJhcmVhIiwid2lkdGgiLCJnYW1lIiwiY3R4IiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJyZW1vdmUiLCJFbnRpdGllcyIsInNwZWNzIiwic3VwZXIiLCJ2ZWxvY2l0eSIsIlZlY3RvciIsIngiLCJ5IiwiYWRkIiwidjEiLCJ2MiIsInN1YnRyYWN0IiwibXVsdGlwbHkiLCJ2IiwidmVjTGVuZ3RoIiwidmVjdG9yIiwiTWF0aCIsInNxcnQiLCJkaXN0YW5jZSIsInAxIiwicDIiLCJwb3ciLCJub3JtYWxpemUiLCJ2ZWN0b3JMZW5ndGgiLCJQbGF5ZXJTaGlwIiwiR2FtZSIsIkJvYXJkIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZ2FtZUJvYXJkIiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRDb250ZXh0IiwiZHJhdyIsImJvYXJkIiwic3RhcnQiLCJ3aW5kb3ciLCJFbmVteVNoaXAiLCJCdWxsZXQiLCJCb21iIiwic2NvcmUiLCJlbmVteVNoaXBzIiwiYnVsbGV0cyIsImJvbWJzIiwid2F2ZUNvdW50IiwiZW5lbWllc0FkZGVkIiwicGxheWVyU2hpcCIsInBsYXllckxpdmVzIiwiZ2FtZUlzT3ZlciIsIm5ld1JvdW5kIiwiYWRkRW5lbWllcyIsImFkZFBsYXllclNoaXAiLCJyZWdpc3RlckV2ZW50cyIsInNoaXAiLCJwdXNoIiwiYnVsbGV0IiwiYm9tYiIsImltZyIsIkltYWdlIiwic3JjIiwib25sb2FkIiwiZHJhd0ltYWdlIiwiZm9udCIsImZpbGxzdHlsZSIsImZpbGxUZXh0IiwiZm9yRWFjaCIsInNoaXBJbmRleCIsImZsb29yIiwicmFuZG9tIiwibGVuZ3RoIiwiYm9tYlBvc2l0aW9uIiwiYWRkQm9tYnMiLCJlbmVteSIsImRlc3Ryb3llZCIsImoiLCJzcGxpY2UiLCJpbmRleE9mIiwiZ2FtZU92ZXIiLCJtYXAiLCJpc091dE9mQm91bmRzIiwibW92ZSIsImNvbnNvbGUiLCJsb2ciLCJib21ic0F3YXkiLCJkaXJlY3Rpb24iLCJlIiwia2V5Q29kZSIsInBvc2l0aW9uIiwiYWRkQnVsbGV0IiwibW92ZVNoaXAiLCJXSURUSCIsImVudGl0eSIsIk5VTV9FTkVNSUVTIiwiSEVJR0hUIiwibW92ZU9iamVjdHMiLCJjaGVja0NvbGxpc2lvbnMiLCJzdHlsZSIsImRpc3BsYXkiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJhbmltYXRlIiwibGFzdFRpbWUiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEVBQUEsR0FHQSxT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LFFBQUF2SCxLQUFBVSxPQU9BRixRQUNBRSxLQUFBOEcsU0FBQSxFQUNBRixzQkFBQTVHLEtBQUE2RyxRQUFBdkgsS0FBQVUiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDMpO1xuIiwiY29uc3QgVmVjdG9yID0gcmVxdWlyZSgnLi92ZWN0b3JzJyk7XG5cbmNsYXNzIEVudGl0aWVzIHtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHRoaXMucG9zID0gcHJvcHMucG9zO1xuICAgICAgICB0aGlzLnZlbCA9IHByb3BzLnZlbDtcbiAgICAgICAgdGhpcy5jb2xvciA9IHByb3BzLmNvbG9yO1xuICAgICAgICB0aGlzLmhlaWdodCA9IHByb3BzLmhlaWdodDtcbiAgICAgICAgdGhpcy5hcmVhID0gdGhpcy5oZWlnaHQgKiB0aGlzLndpZHRoO1xuICAgICAgICB0aGlzLndpZHRoID0gcHJvcHMud2lkdGg7XG4gICAgICAgIHRoaXMuZ2FtZSA9IHByb3BzLmdhbWU7XG4gICAgfVxuXG4gICAgZHJhdyhjdHgpIHtcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMuY29sb3I7XG4gICAgICAgIGN0eC5maWxsUmVjdCh0aGlzLnBvc1swXSwgdGhpcy5wb3NbMV0sIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcbiAgICB9XG5cbiAgICBtb3ZlKCkge1xuICAgICAgICAvLyBjb25zdCBkZWx0YSA9IHRpbWVEZWx0YSB8fCAwLjA1O1xuICAgICAgICB0aGlzLnBvc1swXSArPSAodGhpcy52ZWxbMF0pO1xuICAgIH1cblxuICAgIHJlbW92ZSgpIHtcbiAgICAgICAgdGhpcy5nYW1lLnJlbW92ZSh0aGlzKTtcbiAgICB9XG4gICAgXG59XG5cbmNvbnN0IEZSQU1FX1JBVEVfREVMVEEgPSAxMDAwLzYwO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEVudGl0aWVzOyIsImNvbnN0IFZlY3RvciA9IHJlcXVpcmUoJy4vdmVjdG9ycycpO1xuY29uc3QgRW50aXRpZXMgPSByZXF1aXJlKCcuL2VudGl0aWVzJyk7XG5cbmNsYXNzIFBsYXllclNoaXAgZXh0ZW5kcyBFbnRpdGllcyB7XG4gICAgY29uc3RydWN0b3Ioc3BlY3MpIHtcbiAgICAgICAgc3VwZXIoc3BlY3MpO1xuICAgICAgICB0aGlzLnBvcyA9IHNwZWNzLnBvcztcbiAgICAgICAgdGhpcy5jb2xvciA9ICdsaW1lJztcbiAgICAgICAgdGhpcy53aWR0aCA9IDI1O1xuICAgICAgICB0aGlzLmhlaWdodCA9IDEwO1xuICAgICAgICB0aGlzLnZlbCA9IHNwZWNzLnZlbCB8fCBbMCwgMF07XG4gICAgICAgIHRoaXMuYXJlYSA9IHRoaXMuaGVpZ2h0ICogdGhpcy53aWR0aDtcbiAgICB9XG5cbiAgICBtb3ZlU2hpcCh2ZWxvY2l0eSkge1xuICAgICAgICB0aGlzLnZlbFswXSA9IHZlbG9jaXR5WzBdO1xuICAgIH1cblxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFBsYXllclNoaXA7IiwiY29uc3QgVmVjdG9yID0ge1xuICAgIGNvbnN0cnVjdG9yKHgsIHkpIHtcbiAgICAgICAgdGhpcy54ID0geDtcbiAgICAgICAgdGhpcy55ID0geTtcbiAgICB9LFxuICAgICAgICBcbiAgICBhZGQodjEsIHYyKSB7XG4gICAgICAgIHJldHVybiBuZXcgVmVjdG9yKFxuICAgICAgICAgICAgdjEueCArIHYyLngsXG4gICAgICAgICAgICB2MS55ICsgdjIueVxuICAgICAgICApO1xuICAgIH0sXG4gICAgICAgICAgICBcbiAgICBzdWJ0cmFjdCh2MSwgdjIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IoXG4gICAgICAgICAgICB2MS54IC0gdjIueCxcbiAgICAgICAgICAgIHYxLnkgLSB2Mi55XG4gICAgICAgIClcbiAgICB9LFxuICAgIFxuICAgIG11bHRpcGx5KHYsIG4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IoXG4gICAgICAgICAgICB2LnggKiBuLFxuICAgICAgICAgICAgdi55ICogblxuICAgICAgICApO1xuICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFxuICAgIHZlY0xlbmd0aCh2ZWN0b3IpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguc3FydCh2ZWN0b3IueCAqIHZlY3Rvci54ICsgdmVjdG9yLnkgKiB2ZWN0b3IueSk7XG4gICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgZGlzdGFuY2UocDEsIHAyKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnNxcnQoXG4gICAgICAgICAgICBNYXRoLnBvdyhwMVswXSAtIHAyWzBdLCAyKSArIE1hdGgucG93KHAxWzFdICsgcDJbMV0sIDIpXG4gICAgICAgICk7XG4gICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgIC8vIHRoZSBpZGVhIGhlcmUgaXMgdG8gcmVzZXQgdGhlIGxlbmd0aCBvZiB0aGUgdmVjdG9yIHRvIG9uZS4gSSBmZWVsIGxpa2UgSSBtaWdodCBiZSBtaXNzaW5nIHNvbWUgXG4gICAgLy8gZWRnZSBjYXNlcyBvciBuZWVkIHRvIGFjY291bnQgZm9yIDAsIGJ1dCB3ZSBjYW4gY2lyY2xlIGJhY2sgdG8gdGhpcyB3aGVuIHdlIGltcGxlbWVudFxuICAgIC8vIHRoZSBhY3R1YWwgZ2FtZSBtZWNoYW5pY3NcbiAgICBub3JtYWxpemUodmVjdG9yKSB7XG4gICAgICAgIHJldHVybiBuZXcgVmVjdG9yKFxuICAgICAgICAgICAgdmVjdG9yLnggLyB2ZWN0b3JMZW5ndGgodmVjdG9yKSxcbiAgICAgICAgICAgIHZlY3Rvci55IC8gdmVjdG9yTGVuZ3RoKHZlY3RvcilcbiAgICAgICAgKTtcbiAgICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gVmVjdG9yOyIsImNvbnN0IFBsYXllclNoaXAgPSByZXF1aXJlKCcuL3BsYXllcl9zaGlwJyk7XG5jb25zdCBFbnRpdGllcyA9IHJlcXVpcmUoJy4vZW50aXRpZXMnKTtcbmNvbnN0IEdhbWUgPSByZXF1aXJlKCcuL2dhbWUnKTtcbmNvbnN0IEJvYXJkID0gcmVxdWlyZSgnLi9ib2FyZCcpO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XG4gICAgY29uc3QgZ2FtZUJvYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhbWUtY2FudmFzJyk7XG4gICAgZ2FtZUJvYXJkLndpZHRoID0gNjAwO1xuICAgIGdhbWVCb2FyZC5oZWlnaHQgPSA3MjA7XG4gICAgXG4gICAgY29uc3QgY3R4ID0gZ2FtZUJvYXJkLmdldENvbnRleHQoJzJkJyk7XG5cbiAgICBjb25zdCBnYW1lID0gbmV3IEdhbWUoZ2FtZUJvYXJkKTtcbiAgICBjb25zdCBib2FyZCA9IG5ldyBCb2FyZChnYW1lLCBjdHgpO1xuICAgIGdhbWUuZHJhdyhjdHgpO1xuXG4gICAgY29uc3Qgc3RhcnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhcnQnKTtcbiAgICBcbiAgICBzdGFydC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgY29uc3QgZ2FtZSA9IG5ldyBHYW1lKGdhbWVCb2FyZCk7XG4gICAgICAgIGNvbnN0IGJvYXJkID0gbmV3IEJvYXJkKGdhbWUsIGN0eCk7XG4gICAgICAgIGdhbWUuZHJhdyhjdHgpO1xuICAgICAgICBib2FyZC5zdGFydCgpO1xuICAgIH0pO1xuXG59KVxuXG53aW5kb3cuUGxheWVyU2hpcCA9IFBsYXllclNoaXA7XG53aW5kb3cuRW50aXRpZXMgPSBFbnRpdGllczsiLCJjb25zdCBQbGF5ZXJTaGlwID0gcmVxdWlyZSgnLi9wbGF5ZXJfc2hpcCcpO1xuY29uc3QgRW5lbXlTaGlwID0gcmVxdWlyZSgnLi9lbmVteV9zaGlwJyk7XG5jb25zdCBCdWxsZXQgPSByZXF1aXJlKCcuL2J1bGxldCcpO1xuY29uc3QgQm9tYiA9IHJlcXVpcmUoJy4vYm9tYnMnKTtcblxuY2xhc3MgR2FtZSB7XG4gICAgY29uc3RydWN0b3IoZ2FtZUJvYXJkLCBzY29yZSkge1xuICAgICAgICB0aGlzLmVuZW15U2hpcHMgPSBbXTtcbiAgICAgICAgdGhpcy5idWxsZXRzID0gW107XG4gICAgICAgIHRoaXMuYm9tYnMgPSBbXTtcbiAgICAgICAgdGhpcy53YXZlQ291bnQgPSAwO1xuICAgICAgICB0aGlzLmVuZW1pZXNBZGRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnBsYXllclNoaXAgPSBudWxsO1xuICAgICAgICB0aGlzLmdhbWVCb2FyZCA9IGdhbWVCb2FyZDtcbiAgICAgICAgdGhpcy5wbGF5ZXJMaXZlcyA9IDM7XG4gICAgICAgIHRoaXMuc2NvcmUgPSBzY29yZSB8fCAwO1xuICAgICAgICB0aGlzLmdhbWVJc092ZXIgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5uZXdSb3VuZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJvbWJzID0gW107XG5cbiAgICAgICAgdGhpcy5hZGRFbmVtaWVzKCk7XG4gICAgICAgIHRoaXMuYWRkUGxheWVyU2hpcCgpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnRzKCk7XG4gICAgfVxuXG4gICAgYWRkUGxheWVyU2hpcCgpIHtcbiAgICAgICAgdGhpcy5wbGF5ZXJTaGlwID0gbmV3IFBsYXllclNoaXAoe1xuICAgICAgICAgICAgcG9zOiBbMzAwLCA2NTBdLFxuICAgICAgICAgICAgdmVsOiBbMCwgMF0sXG4gICAgICAgICAgICBoZWlnaHQ6IDIwLFxuICAgICAgICAgICAgd2lkdGg6IDQwLFxuICAgICAgICAgICAgY29sb3I6ICdsaW1lJ1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhZGQoc2hpcCkge1xuICAgICAgICB0aGlzLmVuZW15U2hpcHMucHVzaChzaGlwKTtcbiAgICB9XG5cbiAgICBhZGRCdWxsZXQoYnVsbGV0KSB7XG4gICAgICAgIHRoaXMuYnVsbGV0cy5wdXNoKGJ1bGxldCk7XG4gICAgfVxuXG4gICAgYWRkQm9tYnMoYm9tYikge1xuICAgICAgICB0aGlzLmJvbWJzLnB1c2goYm9tYik7XG4gICAgfVxuXG4gICAgYWRkRW5lbWllcygpIHtcblxuICAgICAgICBsZXQgeSA9IDEwMDtcbiAgICAgICAgZm9yKGxldCBpID0gNTsgaSA+IDE7IGktLSkge1xuICAgICAgICAgICAgbGV0IHggPSA0MDtcbiAgICAgICAgICAgIGZvcihsZXQgbiA9IDA7IG4gPCAxMTsgbisrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGQobmV3IEVuZW15U2hpcCh7XG4gICAgICAgICAgICAgICAgICAgIHBvczogW3gsIHldLFxuICAgICAgICAgICAgICAgICAgICB2ZWw6IFsxLCAwXSxcbiAgICAgICAgICAgICAgICAgICAgZ2FtZTogdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGkgKiAxMFxuICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICAgIHggKz0gNDU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB5ICs9IDM1O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW5lbWllc0FkZGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBkcmF3KGN0eCkge1xuICAgICAgICBjb25zdCBpbWcgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgaW1nLnNyYyA9ICcuLi9hc3NldHMvaW1hZ2VzL2hhbG8uanBnJztcblxuICAgICAgICBpbWcub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShpbWcsIC01MDAsIDApO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIGN0eC50ZXh0QWxpZ24gPSAnY2VudGVyJztcbiAgICAgICAgXG4gICAgICAgIGN0eC5mb250ID0gXCIzMHB4IENvbWljIFNhbnMgTVNcIjtcbiAgICAgICAgY3R4LmZpbGxzdHlsZSA9ICd3aGl0ZSc7XG4gICAgICAgIGN0eC5maWxsVGV4dChgU2NvcmU6ICR7dGhpcy5zY29yZX1gLCA0MTAsIDUwKVxuICAgICAgICBcbiAgICAgICAgY3R4LmZvbnQgPSBcIjMwcHggQ29taWMgU2FucyBNU1wiO1xuICAgICAgICBjdHguZmlsbHN0eWxlID0gJ3doaXRlJztcbiAgICAgICAgY3R4LmZpbGxUZXh0KGBMaXZlczogJHt0aGlzLnBsYXllckxpdmVzfWAsIDIwLCA1MClcblxuICAgICAgICB0aGlzLmVuZW15U2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgICAgICAgc2hpcC5kcmF3KGN0eCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMucGxheWVyU2hpcC5kcmF3KGN0eCk7XG5cbiAgICAgICAgdGhpcy5idWxsZXRzLmZvckVhY2goKGJ1bGxldCkgPT4ge1xuICAgICAgICAgICAgYnVsbGV0LmRyYXcoY3R4KTtcbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLmJvbWJzLmZvckVhY2goKGJvbWIpID0+IHtcbiAgICAgICAgICAgIGJvbWIuZHJhdyhjdHgpO1xuICAgICAgICB9KVxuXG4gICAgfVxuXG4gICAgYm9tYnNBd2F5KCkge1xuICAgICAgICBjb25zdCBzaGlwSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBNYXRoLmZsb29yKHRoaXMuZW5lbXlTaGlwcy5sZW5ndGgpKTtcbiAgICAgICAgY29uc3Qgc2hpcCA9IHRoaXMuZW5lbXlTaGlwc1tzaGlwSW5kZXhdO1xuICAgICAgICBjb25zdCBzaGlwUG9zID0gWyhzaGlwLnBvc1swXSAtIDEwKSwgKHNoaXAucG9zWzFdICsgMTMpXVxuICAgICAgICAvLyBjb25zdCBib21iUG9zaXRpb24gPSBbdGhpcy5lbmVteVNoaXBzW3NoaXBJbmRleF0ucG9zWzBdIC0gMTAsIHRoaXMuZW5lbXlTaGlwc1tzaGlwSW5kZXhdLnBvc1sxXSArIDEzXTtcbiAgICAgICAgY29uc3QgYm9tYlBvc2l0aW9uID0gW3NoaXBQb3NdO1xuICAgICAgICB0aGlzLmFkZEJvbWJzKG5ldyBCb21iKGJvbWJQb3NpdGlvbikpO1xuICAgIH1cblxuICAgIGNoZWNrQ29sbGlzaW9ucygpIHtcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMuZW5lbXlTaGlwcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGV0IGVuZW15ID0gdGhpcy5lbmVteVNoaXBzW2ldO1xuICAgICAgICAgICAgbGV0IGRlc3Ryb3llZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgdGhpcy5idWxsZXRzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYnVsbGV0ID0gdGhpcy5idWxsZXRzW2pdO1xuXG4gICAgICAgICAgICAgICAgaWYoYnVsbGV0LnBvc1swXSA+PSAoZW5lbXkucG9zWzBdIC0gZW5lbXkud2lkdGgvMikgJiYgYnVsbGV0LnBvc1swXSA8PSAoZW5lbXkucG9zWzBdICsgZW5lbXkud2lkdGgvMikgJiZcbiAgICAgICAgICAgICAgICBidWxsZXQucG9zWzFdID49IChlbmVteS5wb3NbMV0gLSBlbmVteS5oZWlnaHQvMikgJiYgYnVsbGV0LnBvc1sxXSA8PSAoZW5lbXkucG9zWzFdICsgZW5lbXkuaGVpZ2h0LzIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnVsbGV0cy5zcGxpY2Uoai0tLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgZGVzdHJveWVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoZGVzdHJveWVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY29yZSArPSB0aGlzLmVuZW15U2hpcHNbaV0udmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5lbmVteVNoaXBzLnNwbGljZShpLS0sIDEpO1xuICAgICAgICAgICAgICAgIGlmKHRoaXMuZW5lbXlTaGlwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idWxsZXRzID0gW107XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkRW5lbWllcygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFBsYXllclNoaXAoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYnVsbGV0cy5mb3JFYWNoKChidWxsZXQpID0+IHtcbiAgICAgICAgICAgICAgICBpZihidWxsZXQucG9zWzFdIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1bGxldHMuc3BsaWNlKHRoaXMuYnVsbGV0cy5pbmRleE9mKGJ1bGxldCksIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBtb3ZlT2JqZWN0cygpIHtcbiAgICAgICAgdGhpcy5lbmVteVNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcblxuICAgICAgICAgICAgaWYodGhpcy5nYW1lT3ZlcihzaGlwLnBvcykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZW15U2hpcHMubWFwKChzaGlwKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHNoaXAudmVsID0gWzAsIDBdO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBuID0gMTtcblxuICAgICAgICAgICAgaWYodGhpcy5pc091dE9mQm91bmRzKHNoaXAucG9zKSkge1xuXG4gICAgICAgICAgICAgICAgaWYoc2hpcC5wb3NbMF0gPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW5lbXlTaGlwcy5tYXAoKHNoaXApID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoaXAucG9zWzFdICs9IDMwO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hpcC5wb3NbMF0gKz0gMTA7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGlwLnZlbCA9IFtuLCAwXTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZW15U2hpcHMubWFwKChzaGlwKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGlwLnBvc1sxXSArPSAzMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoaXAucG9zWzBdIC09IDEwO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hpcC52ZWwgPSBbLShuKSwgMF07XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNoaXAubW92ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMuYnVsbGV0cy5mb3JFYWNoKChidWxsZXQpID0+IHtcbiAgICAgICAgICAgIGJ1bGxldC5wb3NbMV0gLT0gYnVsbGV0LnZlbFsxXTtcbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLmJvbWJzLmZvckVhY2goKGJvbWIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGJvbWIucG9zWzFdICsgYm9tYi52ZWxbMV0pO1xuICAgICAgICAgICAgYm9tYi5wb3NbMV0gKz0gYm9tYi52ZWxbMV07XG4gICAgICAgIH0pXG5cbiAgICAgICAgaWYodGhpcy5ib21icy5sZW5ndGggPCAyKSB7XG4gICAgICAgICAgICB0aGlzLmJvbWJzQXdheSgpO1xuICAgICAgICB9O1xuXG5cbiAgICB9XG4gICAgXG4gICAgcmVnaXN0ZXJFdmVudHMoKSB7XG4gICAgICAgIGxldCBzcGVlZCA9IDI7XG4gICAgICAgIGxldCBkaXJlY3Rpb24gPSB7IFxuICAgICAgICAgICAgeDogMCxcbiAgICAgICAgICAgIHk6IDBcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlID0+IHtcbiAgICAgICAgICAgIGlmKGUua2V5Q29kZSA9PT0gMzcpIHtcbiAgICAgICAgICAgICAgICBpZighdGhpcy5pc091dE9mQm91bmRzKHRoaXMucGxheWVyU2hpcC5wb3MpKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXJTaGlwLnBvc1swXSAtPSAyMDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllclNoaXAudmVsWzBdID0gLXNwZWVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZihlLmtleUNvZGUgPT09IDM5KSB7XG4gICAgICAgICAgICAgICAgaWYoIXRoaXMuaXNPdXRPZkJvdW5kcyh0aGlzLnBsYXllclNoaXAucG9zKSl7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGxheWVyU2hpcC5wb3NbMF0gKz0gMjBcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllclNoaXAudmVsWzBdID0gc3BlZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmKGUua2V5Q29kZSA9PT0gMzIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IFt0aGlzLnBsYXllclNoaXAucG9zWzBdICsgMTAsIHRoaXMucGxheWVyU2hpcC5wb3NbMV0gLSAxM107XG5cbiAgICAgICAgICAgICAgICBpZih0aGlzLmJ1bGxldHMubGVuZ3RoIDwgNykgeyBcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRCdWxsZXQobmV3IEJ1bGxldChwb3NpdGlvbikpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBsYXllclNoaXAubW92ZVNoaXAoZGlyZWN0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaXNPdXRPZkJvdW5kcyhwb3MpIHtcbiAgICAgICAgcmV0dXJuKHBvc1swXSA8IDApIHx8IChwb3NbMF0gKyAyNSA+PSBHYW1lLldJRFRIKVxuICAgIH1cblxuICAgIGdhbWVPdmVyKHBvcykge1xuICAgICAgICBpZihwb3NbMV0gPiA2MjApIHtcbiAgICAgICAgICAgIHRoaXMuZ2FtZUlzT3ZlciA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlbW92ZShlbnRpdHkpIHtcbiAgICAgICAgaWYoZW50aXR5IGluc3RhbmNlb2YgRW5lbXlTaGlwKSB7XG4gICAgICAgICAgICB0aGlzLmVuZW15U2hpcHMuc3BsaWNlKHRoaXMuZW5lbXlTaGlwcy5pbmRleE9mKGVudGl0eSksIDEpO1xuICAgICAgICB9IGVsc2UgaWYoZW50aXR5IGluc3RhbmNlb2YgQnVsbGV0KSB7XG4gICAgICAgICAgICB0aGlzLmJ1bGxldHMuc3BsaWNlKHRoaXMuYnVsbGV0cy5pbmRleE9mKGVudGl0eSksIDEpO1xuICAgICAgICB9XG4gICAgfVxuXG59XG5cbkdhbWUuTlVNX0VORU1JRVMgPSA1NTtcbkdhbWUuSEVJR0hUID0gNzIwO1xuR2FtZS5XSURUSCA9IDYwMDtcblxubW9kdWxlLmV4cG9ydHMgPSBHYW1lOyIsImNvbnN0IEVudGl0aWVzID0gcmVxdWlyZSgnLi9lbnRpdGllcycpO1xuXG5jbGFzcyBFbmVteVNoaXAgZXh0ZW5kcyBFbnRpdGllcyB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnBvcyA9IHByb3BzLnBvcztcbiAgICAgICAgdGhpcy52ZWwgPSBwcm9wcy52ZWw7XG4gICAgICAgIHRoaXMud2lkdGggPSAyNTtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSAxMjtcbiAgICAgICAgdGhpcy5jb2xvciA9ICd3aGl0ZSc7XG4gICAgICAgIHRoaXMuZ2FtZSA9IHByb3BzLmdhbWU7XG4gICAgICAgIHRoaXMuYXJlYSA9IHRoaXMuaGVpZ2h0ICogdGhpcy53aWR0aDtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHByb3BzLnZhbHVlXG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEVuZW15U2hpcDsiLCJjb25zdCBFbnRpdGllcyA9IHJlcXVpcmUoJy4vZW50aXRpZXMnKTtcblxuY2xhc3MgQnVsbGV0IGV4dGVuZHMgRW50aXRpZXMge1xuICAgIGNvbnN0cnVjdG9yKHBvc2l0aW9uKSB7XG4gICAgICAgIHN1cGVyKHBvc2l0aW9uKTtcbiAgICAgICAgdGhpcy5wb3MgPSBwb3NpdGlvbjtcbiAgICAgICAgdGhpcy52ZWwgPSBbMCwgMS41XTtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSA2O1xuICAgICAgICB0aGlzLndpZHRoID0gMztcbiAgICAgICAgdGhpcy5jb2xvciA9ICd3aGl0ZSc7XG4gICAgICAgIHRoaXMuYXJlYSA9IHRoaXMuaGVpZ2h0ICogdGhpcy53aWR0aDtcbiAgICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQnVsbGV0OyIsImNvbnN0IEVudGl0aWVzID0gcmVxdWlyZSgnLi9lbnRpdGllcycpO1xuXG5jbGFzcyBCb21iIGV4dGVuZHMgRW50aXRpZXMge1xuICAgIGNvbnN0cnVjdG9yKHBvc2l0aW9uKSB7XG4gICAgICAgIHN1cGVyKHBvc2l0aW9uKTtcbiAgICAgICAgdGhpcy5wb3MgPSBwb3NpdGlvblswXTtcbiAgICAgICAgdGhpcy52ZWwgPSBbMCwgMS42XTtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSA1O1xuICAgICAgICB0aGlzLndpZHRoID0gMi41O1xuICAgICAgICB0aGlzLmNvbG9yID0gJ3doaXRlJztcbiAgICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQm9tYjsiLCJjbGFzcyBCb2FyZCB7XG4gICAgY29uc3RydWN0b3IoZ2FtZSwgY3R4KSB7XG4gICAgICAgIHRoaXMuY3R4ID0gY3R4O1xuICAgICAgICB0aGlzLmdhbWUgPSBnYW1lO1xuICAgICAgICB0aGlzLnBsYXllclNoaXAgPSBnYW1lLmFkZFBsYXllclNoaXA7XG4gICAgICAgIC8vIHRoaXMubGFzdFRpbWUgPSAwO1xuICAgIH1cblxuICAgIGFuaW1hdGUoKSB7XG4gICAgICAgIC8vIGNvbnN0IGRlbHRhID0gdGltZSAtIHRoaXMubGFzdFRpbWU7XG5cbiAgICAgICAgdGhpcy5nYW1lLmRyYXcodGhpcy5jdHgpO1xuICAgICAgICB0aGlzLmdhbWUubW92ZU9iamVjdHMoKTtcbiAgICAgICAgdGhpcy5nYW1lLmNoZWNrQ29sbGlzaW9ucygpO1xuXG4gICAgICAgIC8vIHRoaXMubGFzdFRpbWUgPSB0aW1lO1xuXG4gICAgICAgIGlmKCF0aGlzLmdhbWUuZ2FtZUlzT3ZlcikgeyBcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLmFuaW1hdGUuYmluZCh0aGlzKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBzY3JlZW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3BsYXNoLXBhZ2UnKTtcbiAgICAgICAgICAgIHNjcmVlbi5zdHlsZS5kaXNwbGF5ID0gXCJmbGV4XCI7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5sYXN0VGltZSA9IDA7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLmFuaW1hdGUuYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIFxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEJvYXJkOyJdLCJzb3VyY2VSb290IjoiIn0=